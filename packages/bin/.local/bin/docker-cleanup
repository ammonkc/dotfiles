#!/usr/bin/env bash
# Clean up Docker resources (containers, images, volumes, networks)
# Usage: docker-cleanup          - interactive mode
#        docker-cleanup --all    - remove everything unused

set -e

if ! command -v docker >/dev/null 2>&1; then
    echo "Docker is not installed"
    exit 1
fi

echo "ğŸ³ Docker Cleanup"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"

# Show current usage
echo "Current disk usage:"
docker system df
echo ""

if [[ "$1" == "--all" ]]; then
    echo "Removing all unused resources..."
    docker system prune -af --volumes
    echo "âœ“ Cleanup complete"
else
    echo "What would you like to clean?"
    echo "  1) Stopped containers"
    echo "  2) Unused images"
    echo "  3) Unused volumes"
    echo "  4) Unused networks"
    echo "  5) Everything unused (containers, images, volumes, networks)"
    echo "  6) Cancel"
    echo ""
    read -p "Choice [1-6]: " -n 1 -r
    echo ""

    case "$REPLY" in
        1)
            docker container prune -f
            ;;
        2)
            docker image prune -af
            ;;
        3)
            docker volume prune -f
            ;;
        4)
            docker network prune -f
            ;;
        5)
            docker system prune -af --volumes
            ;;
        *)
            echo "Cancelled"
            exit 0
            ;;
    esac

    echo ""
    echo "âœ“ Cleanup complete"
    echo ""
    echo "New disk usage:"
    docker system df
fi

