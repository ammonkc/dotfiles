# yaml-language-server: $schema=https://taskfile.dev/schema.json
version: 3

includes:
  brew:
    taskfile: ./brew.yml
    internal: true

  linux:
    taskfile: ./linux.yml
    internal: true

  mise:
    taskfile: ./mise.yml
    internal: true

  dotfiles:
    aliases: [dot]
    taskfile: ./dotfiles.yml

vars:
  HOME: '{{env "HOME"}}'

tasks:
  install:
    desc: Install all system dependencies
    summary: |
      Install all system dependencies

      This task will install all required system tools and dependencies
      for both macOS and Linux platforms.
    cmds:
      - task: install:requirements

  install:requirements:
    internal: true
    cmds:
      - task: install:stow
      - task: dot:install
      - task: install:platform_tools

  install:stow:
    internal: true
    desc: Install stow (required before dotfiles can be stowed)
    cmds:
      - task: brew:install
      - task: linux:install:stow

  update:
    desc: Update all system dependencies
    summary: |
      Updates system packages and mise-managed tools

      On macOS: Updates Homebrew packages
      On Linux: Updates system packages via package manager

      Run this periodically to keep your system up to date
    cmds:
      - task: brew:upgrade
      - task: linux:update
      - task: mise:update

  install:platform_tools:
    internal: true
    cmds:
      - task: brew:install:tools
      - task: linux:install
