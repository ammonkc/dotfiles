# yaml-language-server: $schema=https://taskfile.dev/schema.json
version: 3

tasks:
  # ============================================================================
  # Primary Tasks
  # ============================================================================

  install:
    desc: Install all mise-managed tools from config
    summary: |
      Installs tools defined in .mise.toml or .tool-versions
      This will install all tools even if some are missing
    preconditions:
      - sh: command -v mise >/dev/null 2>&1
        msg: "mise is not installed. Run 'brew install mise' first"
      - sh: test -f .mise.toml || test -f .tool-versions || test -f .mise.local.toml
        msg: "No mise config found (.mise.toml, .tool-versions, or .mise.local.toml)"
    cmds:
      - echo "ğŸ“¦ Installing mise-managed tools..."
      - mise install
      - echo "âœ“ Tools installed successfully"

  update:
    aliases: [up, upgrade]
    desc: Update all mise-managed tools to latest versions
    preconditions:
      - sh: command -v mise >/dev/null 2>&1
        msg: "mise is not installed"
    cmds:
      - echo "ğŸ”„ Updating mise-managed tools..."
      - mise up
      - echo "âœ“ Tools updated successfully"

  list:
    aliases: [ls]
    desc: List all installed tools and their versions
    cmds:
      - mise list

  outdated:
    desc: List all outdated tools
    cmds:
      - mise outdated -l

  # ============================================================================
  # Health Check
  # ============================================================================

  doctor:
    desc: Check mise installation and configuration
    summary: |
      Runs mise doctor to check for issues
      Note: Warnings about missing tools are expected during initial setup
    cmds:
      - echo "ğŸ” Running mise health check..."
      - mise doctor || true
      - echo ""
      - echo "ğŸ’¡ Tip - Warnings about missing tools are normal during setup"
