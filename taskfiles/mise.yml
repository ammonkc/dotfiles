# yaml-language-server: $schema=https://taskfile.dev/schema.json
version: 3

tasks:
  # ============================================================================
  # Primary Tasks
  # ============================================================================

  install:
    desc: Install all mise-managed tools from config
    summary: |
      Installs tools defined in .mise.toml or .tool-versions
      Runs mise doctor first to verify setup
    preconditions:
      - sh: command -v mise >/dev/null 2>&1
        msg: "mise is not installed. Run 'brew install mise' first"
      - sh: test -f .mise.toml || test -f .tool-versions || test -f .mise.local.toml
        msg: "No mise config found (.mise.toml, .tool-versions, or .mise.local.toml)"
    deps:
      - doctor
    cmds:
      - mise install

  update:
    aliases: [up, upgrade]
    desc: Update all mise-managed tools to latest versions
    preconditions:
      - sh: command -v mise >/dev/null 2>&1
        msg: "mise is not installed"
    deps:
      - doctor
    cmds:
      - mise up

  list:
    aliases: [ls]
    desc: List all installed tools and their versions
    cmds:
      - mise list

  outdated:
    desc: List all outdated tools
    cmds:
      - mise outdated -l

  # ============================================================================
  # Health Check
  # ============================================================================

  doctor:
    desc: Check mise installation and configuration
    internal: true
    cmds:
      - mise doctor
